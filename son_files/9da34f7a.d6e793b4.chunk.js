(this.webpackJsonp=this.webpackJsonp||[]).push([["9da34f7a"],{"/UJw":function(e,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getDownstreamPipelineJobs"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"iid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"retried"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pipeline"},arguments:[{kind:"Argument",name:{kind:"Name",value:"iid"},value:{kind:"Variable",name:{kind:"Name",value:"iid"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"jobs"},arguments:[{kind:"Argument",name:{kind:"Name",value:"retried"},value:{kind:"Variable",name:{kind:"Name",value:"retried"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"detailedStatus"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"action"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"confirmationMessage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"icon"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"path"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"detailsPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"group"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hasDetails"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"icon"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tooltip"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"scheduled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"scheduledAt"},arguments:[],directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:664}};n.loc.source={body:"# @feature_category: continuous_integration\nquery getDownstreamPipelineJobs($fullPath: ID!, $iid: ID!, $retried: Boolean) {\n  project(fullPath: $fullPath) {\n    id\n    pipeline(iid: $iid) {\n      id\n      jobs(retried: $retried) {\n        nodes {\n          id\n          detailedStatus {\n            id\n            action {\n              id\n              confirmationMessage\n              icon\n              path\n              title\n            }\n            detailsPath\n            group\n            hasDetails\n            icon\n            name\n            tooltip\n          }\n          name\n          scheduled\n          scheduledAt\n        }\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function a(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}n.definitions.forEach((function(e){if(e.name){var i=new Set;!function e(i,n){if("FragmentSpread"===i.kind)n.add(i.name.value);else if("VariableDefinition"===i.kind){var t=i.type;"NamedType"===t.kind&&n.add(t.name.value)}i.selectionSet&&i.selectionSet.selections.forEach((function(i){e(i,n)})),i.variableDefinitions&&i.variableDefinitions.forEach((function(i){e(i,n)})),i.definitions&&i.definitions.forEach((function(i){e(i,n)}))}(e,i),t[e.name.value]=i}})),e.exports=n,e.exports.getDownstreamPipelineJobs=function(e,i){var n={kind:e.kind,definitions:[a(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var o=t[i]||new Set,l=new Set,r=new Set;for(o.forEach((function(e){r.add(e)}));r.size>0;){var s=r;r=new Set,s.forEach((function(e){l.has(e)||(l.add(e),(t[e]||new Set).forEach((function(e){r.add(e)})))}))}return l.forEach((function(i){var t=a(e,i);t&&n.definitions.push(t)})),n}(n,"getDownstreamPipelineJobs")},AF2l:function(e,i,n){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"playPipelineMiniGraphJob"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CiProcessableID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jobPlay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"job"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"Job"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:182}};t.loc.source={body:'#import "../fragments/job.fragment.graphql"\n\nmutation playPipelineMiniGraphJob($id: CiProcessableID!) {\n  jobPlay(input: { id: $id }) {\n    job {\n      ...Job\n    }\n    errors\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};t.definitions=t.definitions.concat(n("QM7o").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var i=e.name.value;return!a[i]&&(a[i]=!0,!0)})));var o={};function l(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}t.definitions.forEach((function(e){if(e.name){var i=new Set;!function e(i,n){if("FragmentSpread"===i.kind)n.add(i.name.value);else if("VariableDefinition"===i.kind){var t=i.type;"NamedType"===t.kind&&n.add(t.name.value)}i.selectionSet&&i.selectionSet.selections.forEach((function(i){e(i,n)})),i.variableDefinitions&&i.variableDefinitions.forEach((function(i){e(i,n)})),i.definitions&&i.definitions.forEach((function(i){e(i,n)}))}(e,i),o[e.name.value]=i}})),e.exports=t,e.exports.playPipelineMiniGraphJob=function(e,i){var n={kind:e.kind,definitions:[l(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var t=o[i]||new Set,a=new Set,r=new Set;for(t.forEach((function(e){r.add(e)}));r.size>0;){var s=r;r=new Set,s.forEach((function(e){a.has(e)||(a.add(e),(o[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(i){var t=l(e,i);t&&n.definitions.push(t)})),n}(t,"playPipelineMiniGraphJob")},CDM4:function(e,i,n){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"unschedulePipelineMiniGraphJob"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CiBuildID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jobUnschedule"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"job"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"Job"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:188}};t.loc.source={body:'#import "../fragments/job.fragment.graphql"\n\nmutation unschedulePipelineMiniGraphJob($id: CiBuildID!) {\n  jobUnschedule(input: { id: $id }) {\n    job {\n      ...Job\n    }\n    errors\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};t.definitions=t.definitions.concat(n("QM7o").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var i=e.name.value;return!a[i]&&(a[i]=!0,!0)})));var o={};function l(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}t.definitions.forEach((function(e){if(e.name){var i=new Set;!function e(i,n){if("FragmentSpread"===i.kind)n.add(i.name.value);else if("VariableDefinition"===i.kind){var t=i.type;"NamedType"===t.kind&&n.add(t.name.value)}i.selectionSet&&i.selectionSet.selections.forEach((function(i){e(i,n)})),i.variableDefinitions&&i.variableDefinitions.forEach((function(i){e(i,n)})),i.definitions&&i.definitions.forEach((function(i){e(i,n)}))}(e,i),o[e.name.value]=i}})),e.exports=t,e.exports.unschedulePipelineMiniGraphJob=function(e,i){var n={kind:e.kind,definitions:[l(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var t=o[i]||new Set,a=new Set,r=new Set;for(t.forEach((function(e){r.add(e)}));r.size>0;){var s=r;r=new Set,s.forEach((function(e){a.has(e)||(a.add(e),(o[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(i){var t=l(e,i);t&&n.definitions.push(t)})),n}(t,"unschedulePipelineMiniGraphJob")},F4Hw:function(e,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getPipelineStageJobs"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CiStageID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ciPipelineStage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"jobs"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"detailedStatus"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"action"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"confirmationMessage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"icon"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"path"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"detailsPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deploymentDetailsPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"group"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hasDetails"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"icon"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tooltip"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"scheduled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"scheduledAt"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:551}};n.loc.source={body:"# @feature_category: continuous_integration\nquery getPipelineStageJobs($id: CiStageID!) {\n  ciPipelineStage(id: $id) {\n    id\n    jobs {\n      nodes {\n        id\n        detailedStatus {\n          id\n          action {\n            id\n            confirmationMessage\n            icon\n            path\n            title\n          }\n          detailsPath\n          deploymentDetailsPath\n          group\n          hasDetails\n          icon\n          tooltip\n          label\n        }\n        name\n        scheduled\n        scheduledAt\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function a(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}n.definitions.forEach((function(e){if(e.name){var i=new Set;!function e(i,n){if("FragmentSpread"===i.kind)n.add(i.name.value);else if("VariableDefinition"===i.kind){var t=i.type;"NamedType"===t.kind&&n.add(t.name.value)}i.selectionSet&&i.selectionSet.selections.forEach((function(i){e(i,n)})),i.variableDefinitions&&i.variableDefinitions.forEach((function(i){e(i,n)})),i.definitions&&i.definitions.forEach((function(i){e(i,n)}))}(e,i),t[e.name.value]=i}})),e.exports=n,e.exports.getPipelineStageJobs=function(e,i){var n={kind:e.kind,definitions:[a(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var o=t[i]||new Set,l=new Set,r=new Set;for(o.forEach((function(e){r.add(e)}));r.size>0;){var s=r;r=new Set,s.forEach((function(e){l.has(e)||(l.add(e),(t[e]||new Set).forEach((function(e){r.add(e)})))}))}return l.forEach((function(i){var t=a(e,i);t&&n.definitions.push(t)})),n}(n,"getPipelineStageJobs")},HDS3:function(e,i,n){"use strict";var t=n("zIFf"),a=n("d85j"),o=n("FAdU"),l=n("iM2x"),r=(n("3UXl"),n("iyoE"),n("eJ0a"),n("FxFN")),s=n("3twG"),d=n("4wgn");const u=function(e){return Boolean(e.detailedStatus)};var c=n("/lV4"),m=n("CbCZ"),p=n("2TqH"),v=n("Jx7q"),f=n("NnjE"),g=n("jlnU"),h=n("eadt"),b=n("puZj"),k=n("8gZ3"),S=n("KaiL"),j=n("kooW"),w=n("ueZb"),N=n("/UJw"),y=n.n(N),D={name:"DownstreamPipelineDropdown",directives:{GlTooltip:t.a},components:{CiIcon:l.a,GlButton:m.a,GlDisclosureDropdown:p.a,GlLink:v.a,GlLoadingIcon:f.a,JobDropdownItem:w.a,TooltipOnTruncate:h.a},props:{pipeline:{type:Object,required:!0}},emits:["jobActionExecuted"],data:()=>({isDropdownOpen:!1,pipelineJobs:[]}),apollo:{pipelineJobs:{context(){return Object(k.c)(this.graphqlEtag)},query:y.a,variables(){return{iid:this.pipeline.iid,fullPath:this.projectPath,retried:!1}},skip(){return!this.isDropdownOpen||!this.projectPath},pollInterval:j.q,update({project:e}){var i;return function(e){return e?[...e].sort((function(e,i){const n={failed:-3,manual:-2,success:1};return(n[e.detailedStatus.group]||0)-(n[i.detailedStatus.group]||0)})):[]}((null==e||null===(i=e.pipeline)||void 0===i||null===(i=i.jobs)||void 0===i?void 0:i.nodes)||[])},error(e){Object(g.createAlert)({message:Object(c.i)("Pipelines|There was a problem fetching the downstream pipeline jobs.")}),Object(b.a)(this.$options.name,e)}}},computed:{dropdownAriaLabel(){return Object(c.j)(Object(c.a)("View Pipeline: %{title}"),{title:this.pipelineName})},dropdownHeaderText(){return`${Object(c.a)("Pipeline")}: ${this.pipelineName}`},dropdownTooltipTitle(){var e;const i=(null===(e=this.pipeline)||void 0===e||null===(e=e.detailedStatus)||void 0===e?void 0:e.label)||Object(c.a)("unknown");return`${this.pipelineName} - ${i}`},graphqlEtag(){return Object(S.e)("/api/graphql",this.pipelineId)},isLoading(){return this.$apollo.queries.pipelineJobs.loading},pipelineId(){return Object(r.f)(this.pipeline.id).toString()},pipelineName(){var e,i;return(null===(e=this.pipeline)||void 0===e?void 0:e.name)||(null===(i=this.pipeline)||void 0===i||null===(i=i.project)||void 0===i?void 0:i.name)||Object(c.a)("Downstream pipeline")},projectPath(){var e;return(null===(e=this.pipeline)||void 0===e||null===(e=e.project)||void 0===e?void 0:e.fullPath)||""}},mounted(){Object(k.f)(this.$apollo.queries.pipelineJobs)},methods:{onHideDropdown(){this.isDropdownOpen=!1,this.$apollo.queries.pipelineJobs.stopPolling()},onShowDropdown(){this.isDropdownOpen=!0,this.$apollo.queries.pipelineJobs.startPolling(j.q)}}},P=n("tBpV"),x=Object(P.a)(D,(function(){var e=this,i=e._self._c;return i("gl-disclosure-dropdown",{staticClass:"pipeline-mini-graph-stage-container",attrs:{"data-testid":"pipeline-mini-graph-dropdown","aria-label":e.dropdownAriaLabel,"fluid-width":""},on:{hidden:e.onHideDropdown,shown:e.onShowDropdown},scopedSlots:e._u([{key:"toggle",fn:function({accessibilityAttributes:n}){return[i("gl-button",e._b({directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.hover",value:e.dropdownTooltipTitle,expression:"dropdownTooltipTitle",modifiers:{hover:!0}}],staticClass:"!gl-rounded-full",attrs:{"data-testid":"pipeline-mini-graph-dropdown-toggle",title:e.dropdownTooltipTitle,variant:"link"}},"gl-button",n,!1),[i("ci-icon",{attrs:{status:e.pipeline.detailedStatus,"show-tooltip":!1,"use-link":!1}})],1)]}},{key:"header",fn:function(){return[i("div",{staticClass:"gl-flex gl-min-h-10 gl-w-34 gl-flex-col gl-gap-2 gl-border-b-1 gl-border-b-dropdown !gl-p-4 gl-text-sm gl-leading-1 gl-border-b-solid"},[i("span",{staticClass:"gl-font-bold"},[e._v(e._s(e.dropdownHeaderText))]),e._v(" "),i("p",{staticClass:"!gl-m-0"},[i("tooltip-on-truncate",{staticClass:"gl-grow gl-truncate gl-text-default",attrs:{title:e.pipelineId}},[i("gl-link",{attrs:{href:e.pipeline.path}},[e._v("#"+e._s(e.pipelineId))])],1)],1)])]},proxy:!0}])},[e._v(" "),e._v(" "),e.isLoading?i("div",{staticClass:"gl-flex gl-gap-3 gl-px-4 gl-py-3"},[i("gl-loading-icon",{attrs:{size:"sm"}}),e._v(" "),i("span",{staticClass:"gl-leading-normal"},[e._v(e._s(e.__("Loading…")))])],1):i("ul",{staticClass:"gl-m-0 gl-w-34 gl-overflow-y-auto gl-p-0",attrs:{"data-testid":"downstream-jobs-list"},on:{click:function(e){e.stopPropagation()}}},e._l(e.pipelineJobs,(function(n){return i("job-dropdown-item",{key:n.id,attrs:{job:n},on:{jobActionExecuted:function(i){return e.$emit("jobActionExecuted")}}})})),1)])}),[],!1,null,null,null).exports,T={name:"DownstreamPipelines",directives:{GlTooltip:t.a},components:{DownstreamPipelineDropdown:x},props:{pipelines:{type:Array,required:!1,default:function(){return[]}},pipelinePath:{type:String,required:!1,default:""}},data:()=>({maxRenderedPipelines:3}),computed:{totalPipelineCount(){return this.pipelines.length},pipelinesTrimmed(){return this.totalPipelineCount>this.maxRenderedPipelines?this.pipelines.slice(0,this.maxRenderedPipelines):this.pipelines},shouldRenderCounter(){return this.pipelines.length>this.maxRenderedPipelines},counterLabel(){return"+"+(this.pipelines.length-this.maxRenderedPipelines)},counterTooltipText(){return Object(c.j)(Object(c.h)("Pipelines|%{counterLabel} more downstream pipeline","Pipelines|%{counterLabel} more downstream pipelines",this.counterLabel),{counterLabel:this.counterLabel})}}},O=Object(P.a)(T,(function(){var e=this,i=e._self._c;return e.pipelines?i("span",{staticClass:"gl-contents gl-align-middle"},[e._l(e.pipelinesTrimmed,(function(n){return i("downstream-pipeline-dropdown",{key:n.id,staticClass:"gl-mr-2 last-of-type:gl-mr-0",attrs:{pipeline:n},on:{jobActionExecuted:function(i){return e.$emit("jobActionExecuted")}}})})),e._v(" "),e.shouldRenderCounter?i("a",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:{title:e.counterTooltipText},expression:"{ title: counterTooltipText }"}],staticClass:"gl-inline-flex gl-h-6 gl-w-7 gl-items-center gl-justify-center gl-rounded-pill gl-bg-strong gl-text-sm gl-text-subtle gl-no-underline",attrs:{title:e.counterTooltipText,href:e.pipelinePath,"data-testid":"downstream-pipeline-counter"}},[e._v("\n    "+e._s(e.counterLabel)+"\n  ")]):e._e()],2):e._e()}),[],!1,null,null,null).exports,J=(n("UezY"),n("z6RN"),n("hG7+"),n("nuJP")),_=n("1I5c"),F=n("F4Hw"),C=n.n(F);var E={name:"PipelineStageDropdown",components:{CiIcon:l.a,GlButton:m.a,GlDisclosureDropdown:p.a,GlDisclosureDropdownGroup:J.a,GlLoadingIcon:f.a,GlSearchBoxByType:_.a,JobDropdownItem:w.a},directives:{GlTooltip:t.a},props:{isMergeTrain:{type:Boolean,required:!1,default:!1},stage:{type:Object,required:!0}},emits:["jobActionExecuted","miniGraphStageClick"],data:()=>({isDropdownOpen:!1,stageJobs:[],search:""}),apollo:{stageJobs:{context(){return{...Object(k.c)(this.graphqlEtag),featureCategory:"continuous_integration"}},query:C.a,variables(){return{id:this.stage.id}},skip(){return!this.isDropdownOpen},pollInterval:j.q,update(e){var i;return(null==e||null===(i=e.ciPipelineStage)||void 0===i||null===(i=i.jobs)||void 0===i?void 0:i.nodes)||[]},error(e){Object(g.createAlert)({message:Object(c.i)("Pipelines|There was a problem fetching the pipeline stage jobs.")}),Object(b.a)(this.$options.name,e)}}},computed:{dropdownHeaderText(){return Object(c.j)(Object(c.a)("Stage: %{stageName}"),{stageName:this.stage.name})},dropdownTooltipTitle(){return this.isDropdownOpen?"":`${this.stage.name}: ${this.stage.detailedStatus.tooltip}`},failedJobs(){return this.stageJobs.filter((function(e){return e.detailedStatus.group===j.e}))},graphqlEtag(){return Object(S.f)("/api/graphql",Object(r.f)(this.stage.id))},hasFailedJobs(){return Boolean(this.failedJobs.length)},hasPassedJobs(){return Boolean(this.passedJobs.length)},isLoading(){return this.$apollo.queries.stageJobs.loading},passedJobs(){return this.stageJobs.filter((function(e){return e.detailedStatus.group!==j.e}))},searchedJobs(){var e=this;return this.stageJobs.filter((function(i){return i.name.toLowerCase().includes(e.search.toLowerCase())}))},searchVisible(){return!this.isLoading&&this.stageJobs.length>12}},mounted(){Object(k.f)(this.$apollo.queries.stageJobs)},methods:{onHideDropdown(){this.isDropdownOpen=!1,this.$apollo.queries.stageJobs.stopPolling(),this.search=""},onShowDropdown(){this.isDropdownOpen=!0,this.$apollo.queries.stageJobs.startPolling(j.q),this.$emit("miniGraphStageClick")},stageAriaLabel:e=>Object(c.j)(Object(c.a)("View Stage: %{title}"),{title:e})}},A={name:"PipelineStages",components:{PipelineStageDropdown:Object(P.a)(E,(function(){var e=this,i=e._self._c;return i("gl-disclosure-dropdown",{attrs:{"data-testid":"pipeline-mini-graph-dropdown","aria-label":e.stageAriaLabel(e.stage.name),"fluid-width":""},on:{hidden:e.onHideDropdown,shown:e.onShowDropdown},scopedSlots:e._u([{key:"toggle",fn:function({accessibilityAttributes:n}){return[i("gl-button",e._b({directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.hover",value:e.dropdownTooltipTitle,expression:"dropdownTooltipTitle",modifiers:{hover:!0}}],staticClass:"!gl-rounded-full",attrs:{"data-testid":"pipeline-mini-graph-dropdown-toggle",title:e.dropdownTooltipTitle,variant:"link"}},"gl-button",n,!1),[i("ci-icon",{attrs:{status:e.stage.detailedStatus,"show-tooltip":!1,"use-link":!1}})],1)]}},{key:"header",fn:function(){return[i("div",{staticClass:"gl-border-b gl-flex gl-min-h-8 gl-items-center !gl-p-4 gl-text-sm gl-font-bold gl-leading-1 gl-border-b-solid",attrs:{"data-testid":"pipeline-stage-dropdown-menu-title"}},[i("span",[e._v(e._s(e.dropdownHeaderText))])]),e._v(" "),e.searchVisible?i("gl-search-box-by-type",{staticClass:"pipeline-mini-graph-search",attrs:{borderless:""},model:{value:e.search,callback:function(i){e.search=i},expression:"search"}}):e._e()]},proxy:!0},{key:"footer",fn:function(){return[!e.isLoading&&e.isMergeTrain?i("div",{staticClass:"gl-border-t gl-px-4 gl-py-3 gl-text-sm gl-text-subtle",attrs:{"data-testid":"merge-train-message"}},[e._v("\n      "+e._s(e.s__("Pipeline|Merge train pipeline jobs can not be retried"))+"\n    ")]):e._e()]},proxy:!0}])},[e._v(" "),e._v(" "),e.isLoading?i("div",{staticClass:"gl-flex gl-gap-3 gl-px-4 gl-py-3"},[i("gl-loading-icon",{attrs:{size:"sm"}}),e._v(" "),i("span",{staticClass:"gl-leading-normal"},[e._v(e._s(e.__("Loading…")))])],1):i("ul",{staticClass:"gl-m-0 gl-w-34 gl-overflow-y-auto gl-p-0",attrs:{"data-testid":"pipeline-mini-graph-dropdown-menu-list"},on:{click:function(e){e.stopPropagation()}}},[e.search?[e.searchedJobs.length?i("gl-disclosure-dropdown-group",{key:"searched-jobs",attrs:{"data-testid":"searched-jobs"}},e._l(e.searchedJobs,(function(n){return i("job-dropdown-item",{key:n.id+"searched",attrs:{job:n},on:{jobActionExecuted:function(i){return e.$emit("jobActionExecuted")}}})})),1):e._e()]:[e.hasFailedJobs?i("gl-disclosure-dropdown-group",{staticClass:"gl-text-left",scopedSlots:e._u([{key:"group-label",fn:function(){return[i("span",{staticClass:"gl-inline-block gl-w-full gl-text-left"},[e._v(e._s(e.s__("Pipelines|Failed jobs")))])]},proxy:!0}],null,!1,4074987192)},[e._v(" "),e._l(e.failedJobs,(function(n){return i("job-dropdown-item",{key:n.id,attrs:{job:n},on:{jobActionExecuted:function(i){return e.$emit("jobActionExecuted")}}})}))],2):e._e(),e._v(" "),e.hasPassedJobs?i("gl-disclosure-dropdown-group",{attrs:{bordered:e.hasFailedJobs,"data-testid":"passed-jobs"}},e._l(e.passedJobs,(function(n){return i("job-dropdown-item",{key:n.id,attrs:{job:n},on:{jobActionExecuted:function(i){return e.$emit("jobActionExecuted")}}})})),1):e._e()]],2)])}),[],!1,null,null,null).exports},props:{isMergeTrain:{type:Boolean,required:!1,default:!1},stages:{type:Array,required:!0}},emits:["jobActionExecuted","miniGraphStageClick"]},M=Object(P.a)(A,(function(){var e=this,i=e._self._c;return i("div",{staticClass:"gl-contents gl-align-middle"},e._l(e.stages,(function(n){return i("div",{key:n.id,staticClass:"pipeline-mini-graph-stage-container dropdown gl-my-1 gl-mr-2 gl-inline-flex gl-align-middle"},[i("pipeline-stage-dropdown",{attrs:{stage:n,"is-merge-train":e.isMergeTrain},on:{jobActionExecuted:function(i){return e.$emit("jobActionExecuted")},miniGraphStageClick:function(i){return e.$emit("miniGraphStageClick")}}})],1)})),0)}),[],!1,null,null,null).exports,q={name:"PipelineMiniGraph",arrowStyles:["arrow-icon gl-inline-block gl-mx-1 gl-text-subtle !gl-align-middle"],directives:{GlTooltip:t.a},components:{CiIcon:l.a,DownstreamPipelines:O,GlIcon:a.a,PipelineStages:M},props:{downstreamPipelines:{type:Array,required:!1,default:function(){return[]}},isMergeTrain:{type:Boolean,required:!1,default:!1},pipelinePath:{type:String,required:!1,default:""},pipelineStages:{type:Array,required:!0},upstreamPipeline:{type:Object,required:!1,default:function(){}}},emits:["jobActionExecuted","miniGraphStageClick"],computed:{formattedDownstreamPipelines(){return this.downstreamPipelines.map((function(e){if(u(e))return e;const{id:i,iid:n,details:t,name:a,path:o,project:l}=e;return{id:Object(r.c)(d.i,i),iid:n,detailedStatus:null==t?void 0:t.status,name:a,path:o,project:{fullPath:Object(s.f)(l.full_path),name:l.name}}}))},formattedStages(){return this.pipelineStages.map((function(e){if(u(e))return e;const{id:i,name:n,status:t}=e;return{id:Object(r.c)(d.k,i),detailedStatus:{icon:t.icon,label:t.label,tooltip:t.tooltip},name:n}}))},hasDownstreamPipelines(){return Boolean(this.latestDownstreamPipelines.length)},hasUpstreamPipeline(){var e;return null===(e=this.upstreamPipeline)||void 0===e?void 0:e.id},latestDownstreamPipelines(){return Object(o.b)(this.formattedDownstreamPipelines)},upstreamPipelineStatus(){var e,i;return(null===(e=this.upstreamPipeline)||void 0===e?void 0:e.detailedStatus)||(null===(i=this.upstreamPipeline)||void 0===i||null===(i=i.details)||void 0===i?void 0:i.status)},upstreamTooltipText(){var e,i;return`${null===(e=this.upstreamPipeline)||void 0===e||null===(e=e.project)||void 0===e?void 0:e.name} - ${null===(i=this.upstreamPipelineStatus)||void 0===i?void 0:i.label}`}}},I=Object(P.a)(q,(function(){var e=this,i=e._self._c;return i("div",{attrs:{"data-testid":"pipeline-mini-graph"}},[e.hasUpstreamPipeline?i("ci-icon",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.hover",modifiers:{hover:!0}}],staticClass:"gl-align-middle",attrs:{title:e.upstreamTooltipText,"aria-label":e.upstreamTooltipText,status:e.upstreamPipelineStatus,"show-tooltip":!1,"data-testid":"pipeline-mini-graph-upstream"}}):e._e(),e._v(" "),e.hasUpstreamPipeline?i("gl-icon",{class:e.$options.arrowStyles,attrs:{name:"arrow-right","data-testid":"upstream-arrow-icon",variant:"subtle"}}):e._e(),e._v(" "),i("pipeline-stages",{attrs:{"is-merge-train":e.isMergeTrain,stages:e.formattedStages},on:{jobActionExecuted:function(i){return e.$emit("jobActionExecuted")},miniGraphStageClick:function(i){return e.$emit("miniGraphStageClick")}}}),e._v(" "),e.hasDownstreamPipelines?i("gl-icon",{class:e.$options.arrowStyles,attrs:{name:"arrow-right","data-testid":"downstream-arrow-icon",variant:"subtle"}}):e._e(),e._v(" "),e.hasDownstreamPipelines?i("downstream-pipelines",{attrs:{pipelines:e.latestDownstreamPipelines,"pipeline-path":e.pipelinePath,"data-testid":"pipeline-mini-graph-downstream"}}):e._e()],1)}),[],!1,null,null,null);i.a=I.exports},PUmL:function(e,i,n){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"cancelPipelineMiniGraphJob"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CiBuildID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jobCancel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"job"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"Job"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:180}};t.loc.source={body:'#import "../fragments/job.fragment.graphql"\n\nmutation cancelPipelineMiniGraphJob($id: CiBuildID!) {\n  jobCancel(input: { id: $id }) {\n    job {\n      ...Job\n    }\n    errors\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};t.definitions=t.definitions.concat(n("QM7o").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var i=e.name.value;return!a[i]&&(a[i]=!0,!0)})));var o={};function l(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}t.definitions.forEach((function(e){if(e.name){var i=new Set;!function e(i,n){if("FragmentSpread"===i.kind)n.add(i.name.value);else if("VariableDefinition"===i.kind){var t=i.type;"NamedType"===t.kind&&n.add(t.name.value)}i.selectionSet&&i.selectionSet.selections.forEach((function(i){e(i,n)})),i.variableDefinitions&&i.variableDefinitions.forEach((function(i){e(i,n)})),i.definitions&&i.definitions.forEach((function(i){e(i,n)}))}(e,i),o[e.name.value]=i}})),e.exports=t,e.exports.cancelPipelineMiniGraphJob=function(e,i){var n={kind:e.kind,definitions:[l(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var t=o[i]||new Set,a=new Set,r=new Set;for(t.forEach((function(e){r.add(e)}));r.size>0;){var s=r;r=new Set,s.forEach((function(e){a.has(e)||(a.add(e),(o[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(i){var t=l(e,i);t&&n.definitions.push(t)})),n}(t,"cancelPipelineMiniGraphJob")},QM7o:function(e,i){var n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"Job"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CiJob"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"detailedStatus"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"action"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"confirmationMessage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"icon"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"path"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:149}};n.loc.source={body:"fragment Job on CiJob {\n  id\n  detailedStatus {\n    id\n    action {\n      id\n      confirmationMessage\n      icon\n      path\n      title\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function a(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}n.definitions.forEach((function(e){if(e.name){var i=new Set;!function e(i,n){if("FragmentSpread"===i.kind)n.add(i.name.value);else if("VariableDefinition"===i.kind){var t=i.type;"NamedType"===t.kind&&n.add(t.name.value)}i.selectionSet&&i.selectionSet.selections.forEach((function(i){e(i,n)})),i.variableDefinitions&&i.variableDefinitions.forEach((function(i){e(i,n)})),i.definitions&&i.definitions.forEach((function(i){e(i,n)}))}(e,i),t[e.name.value]=i}})),e.exports=n,e.exports.Job=function(e,i){var n={kind:e.kind,definitions:[a(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var o=t[i]||new Set,l=new Set,r=new Set;for(o.forEach((function(e){r.add(e)}));r.size>0;){var s=r;r=new Set,s.forEach((function(e){l.has(e)||(l.add(e),(t[e]||new Set).forEach((function(e){r.add(e)})))}))}return l.forEach((function(i){var t=a(e,i);t&&n.definitions.push(t)})),n}(n,"Job")},YMJc:function(e,i,n){"use strict";var t=n("bOix");i.a={data:()=>({remainingTime:Object(t.C)(0),remainingTimeIntervalId:null}),mounted(){this.startRemainingTimeInterval()},beforeDestroy(){this.remainingTimeIntervalId&&clearInterval(this.remainingTimeIntervalId)},computed:{isDelayedJob(){var e,i;return(null===(e=this.job)||void 0===e?void 0:e.scheduled)||(null===(i=this.job)||void 0===i?void 0:i.scheduledAt)},scheduledTime(){return this.job.scheduled_at||this.job.scheduledAt}},watch:{isDelayedJob(){this.startRemainingTimeInterval()}},methods:{startRemainingTimeInterval(){var e=this;this.remainingTimeIntervalId&&clearInterval(this.remainingTimeIntervalId),this.isDelayedJob&&(this.updateRemainingTime(),this.remainingTimeIntervalId=setInterval((function(){return e.updateRemainingTime()}),1e3))},updateRemainingTime(){const e=Object(t.g)(this.scheduledTime);this.remainingTime=Object(t.C)(e)}}}},nW4g:function(e,i,n){"use strict";var t={name:"JobNameComponent",components:{CiIcon:n("iM2x").a},props:{name:{type:String,required:!0},status:{type:Object,required:!0},iconSize:{type:Number,required:!1,default:16}}},a=n("tBpV"),o=Object(a.a)(t,(function(){var e=this._self._c;return e("span",{staticClass:"gl-flex gl-items-center"},[e("ci-icon",{staticClass:"gl-leading-0",attrs:{size:this.iconSize,status:this.status,"show-tooltip":!1,"use-link":!1}}),this._v(" "),e("span",{staticClass:"gl-line-clamp-2 gl-pl-3 gl-text-left gl-wrap-anywhere",attrs:{title:this.name}},[this._v("\n    "+this._s(this.name)+"\n  ")])],1)}),[],!1,null,null,null);i.a=o.exports},"rhv/":function(e,i,n){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"retryPipelineMiniGraphJob"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CiProcessableID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jobRetry"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"job"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"Job"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:184}};t.loc.source={body:'#import "../fragments/job.fragment.graphql"\n\nmutation retryPipelineMiniGraphJob($id: CiProcessableID!) {\n  jobRetry(input: { id: $id }) {\n    job {\n      ...Job\n    }\n    errors\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};t.definitions=t.definitions.concat(n("QM7o").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var i=e.name.value;return!a[i]&&(a[i]=!0,!0)})));var o={};function l(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}t.definitions.forEach((function(e){if(e.name){var i=new Set;!function e(i,n){if("FragmentSpread"===i.kind)n.add(i.name.value);else if("VariableDefinition"===i.kind){var t=i.type;"NamedType"===t.kind&&n.add(t.name.value)}i.selectionSet&&i.selectionSet.selections.forEach((function(i){e(i,n)})),i.variableDefinitions&&i.variableDefinitions.forEach((function(i){e(i,n)})),i.definitions&&i.definitions.forEach((function(i){e(i,n)}))}(e,i),o[e.name.value]=i}})),e.exports=t,e.exports.retryPipelineMiniGraphJob=function(e,i){var n={kind:e.kind,definitions:[l(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var t=o[i]||new Set,a=new Set,r=new Set;for(t.forEach((function(e){r.add(e)}));r.size>0;){var s=r;r=new Set,s.forEach((function(e){a.has(e)||(a.add(e),(o[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(i){var t=l(e,i);t&&n.definitions.push(t)})),n}(t,"retryPipelineMiniGraphJob")},ueZb:function(e,i,n){"use strict";n("eJ0a");var t=n("AxB5"),a=n("zIFf"),o=n("/lV4"),l=n("0AwG"),r=n("YMJc"),s=n("CbCZ"),d=n("d85j"),u=n("NnjE"),c=n("jlnU"),m=n("puZj"),p=n("PUmL"),v=n.n(p),f=n("AF2l"),g=n.n(f),h=n("rhv/"),b=n.n(h),k=n("CDM4"),S=n.n(k),j=n("Oxu3"),w={name:"JobActionModal",i18n:{title:Object(o.i)("PipelineGraph|Are you sure you want to run %{jobName}?"),confirmationText:Object(o.i)("PipelineGraph|Do you want to continue?"),actionCancel:{text:Object(o.a)("Cancel")}},components:{GlModal:j.a},model:{prop:"visible",event:"change"},props:{customMessage:{type:String,required:!0},visible:{type:Boolean,required:!1,default:!1},jobName:{type:String,required:!0}},emits:["change","confirm"],computed:{modalText(){return{confirmButton:{text:Object(o.j)(Object(o.a)("Yes, run %{jobName}"),{jobName:this.jobName})},message:Object(o.j)(Object(o.a)("Custom confirmation message: %{message}"),{message:this.customMessage}),title:Object(o.j)(this.$options.i18n.title,{jobName:this.jobName})}}}},N=n("tBpV"),y=Object(N.a)(w,(function(){var e=this,i=e._self._c;return i("gl-modal",{attrs:{"modal-id":"job-action-modal","action-cancel":e.$options.i18n.actionCancel,"action-primary":e.modalText.confirmButton,title:e.modalText.title,visible:e.visible},on:{primary:function(i){return e.$emit("confirm")},change:function(i){return e.$emit("change",i)}}},[i("div",[i("p",[e._v(e._s(e.modalText.message))]),e._v(" "),i("span",[e._v(e._s(e.$options.i18n.confirmationText))])])])}),[],!1,null,null,null).exports;const D={errors:{cancelJob:Object(o.i)("Pipeline|There was a problem canceling the job."),playJob:Object(o.i)("Pipeline|There was a problem running the job."),retryJob:Object(o.i)("Pipeline|There was a problem running the job again."),unscheduleJob:Object(o.i)("Pipeline|There was a problem unscheduling the job.")}};var P={name:"JobActionButton",JOB_ACTIONS:{cancel:{dataName:"jobCancel",error:D.errors.cancelJob,mutation:v.a},play:{dataName:"jobPlay",error:D.errors.playJob,mutation:g.a},stop:{dataName:"jobPlay",error:D.errors.playJob,mutation:g.a},retry:{dataName:"jobRetry",error:D.errors.retryJob,mutation:b.a},"time-out":{dataName:"jobUnschedule",error:D.errors.unscheduleJob,mutation:S.a}},i18n:D,components:{GlButton:s.a,GlIcon:d.a,GlLoadingIcon:u.a,JobActionModal:y},directives:{GlTooltip:a.a},props:{jobId:{type:String,required:!0},jobAction:{type:Object,required:!0},jobName:{type:String,required:!0},disabled:{type:Boolean,required:!1,default:!1}},emits:["jobActionExecuted"],data:()=>({isLoading:!1,showConfirmationModal:!1}),computed:{actionType(){return this.jobAction.icon},hasConfirmationModal(){var e;return null!==(null===(e=this.jobAction)||void 0===e?void 0:e.confirmationMessage)}},methods:{onActionButtonClick(){this.hasConfirmationModal?this.showConfirmationModal=!0:this.executeJobAction()},async executeJobAction(){try{this.isLoading=!0;const{data:{[this.$options.JOB_ACTIONS[this.actionType].dataName]:{errors:e}}}=await this.$apollo.mutate({mutation:this.$options.JOB_ACTIONS[this.actionType].mutation,variables:{id:this.jobId}});e.length&&Object(m.a)(this.$options.name,new Error(e.join(", ")))}catch(e){Object(c.createAlert)({message:this.$options.JOB_ACTIONS[this.actionType].error}),Object(m.a)(this.$options.name,e)}finally{this.isLoading=!1,this.$emit("jobActionExecuted")}}}},x={name:"JobDropdownItem",components:{JobActionButton:Object(N.a)(P,(function(){var e=this,i=e._self._c;return i("div",[i("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.viewport.left",modifiers:{viewport:!0,left:!0}}],staticClass:"gl-h-6 gl-w-6 !gl-rounded-full !gl-p-0",attrs:{title:e.jobAction.title,"aria-label":e.jobAction.title,disabled:e.isLoading||e.disabled,size:"small","data-testid":"ci-action-button"},on:{click:function(i){return i.preventDefault(),e.onActionButtonClick.apply(null,arguments)}}},[e.isLoading?i("gl-loading-icon",{attrs:{size:"sm"}}):i("gl-icon",{attrs:{name:e.jobAction.icon,size:12}})],1),e._v(" "),e.hasConfirmationModal?i("job-action-modal",{attrs:{"job-name":e.jobName,"custom-message":e.jobAction.confirmationMessage},on:{confirm:e.executeJobAction},model:{value:e.showConfirmationModal,callback:function(i){e.showConfirmationModal=i},expression:"showConfirmationModal"}}):e._e()],1)}),[],!1,null,null,null).exports,JobNameComponent:n("nW4g").a,GlDisclosureDropdownItem:t.a},directives:{GlTooltip:a.a},mixins:[r.a],props:{job:{type:Object,required:!0}},emits:["jobActionExecuted"],computed:{hasJobAction(){var e,i;return Boolean((null===(e=this.status)||void 0===e||null===(e=e.action)||void 0===e?void 0:e.id)&&(null===(i=this.status)||void 0===i||null===(i=i.action)||void 0===i?void 0:i.icon))},item(){var e,i;return{text:this.job.name,href:(null===(e=this.status)||void 0===e?void 0:e.detailsPath)||(null===(i=this.status)||void 0===i?void 0:i.deploymentDetailsPath)||""}},status(){return this.job.detailedStatus||this.job.status},isFailed(){var e;return"failed"===(null===(e=this.status)||void 0===e?void 0:e.group)},tooltipText(){var e;const i=Object(l.f)(null===(e=this.status)||void 0===e?void 0:e.tooltip);return this.isDelayedJob?Object(o.j)(i,{remainingTime:this.remainingTime}):i},hasUnauthorizedManualAction(){var e,i;return!(null!==(e=this.status)&&void 0!==e&&e.action)&&"manual"===(null===(i=this.status)||void 0===i?void 0:i.group)},unauthorizedManualAction(){var e;return{title:Object(o.a)("You are not authorized to run this manual job"),icon:null===(e=this.status)||void 0===e||null===(e=e.label)||void 0===e?void 0:e.split(" ")[1],confirmationMessage:null}}}},T=Object(N.a)(x,(function(){var e=this,i=e._self._c;return i("gl-disclosure-dropdown-item",{staticClass:"ci-job-component",class:{"ci-job-item-failed":e.isFailed},attrs:{item:e.item,"data-testid":"ci-job-item"},scopedSlots:e._u([{key:"list-item",fn:function(){return[i("div",{staticClass:"-gl-my-2 gl-flex gl-items-center gl-justify-between"},[i("job-name-component",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.viewport.left",modifiers:{viewport:!0,left:!0}}],attrs:{title:e.tooltipText,name:e.job.name,status:e.status,"data-testid":"job-name"}}),e._v(" "),e.hasJobAction?i("job-action-button",{staticClass:"gl-ml-6",attrs:{"job-id":e.job.id,"job-action":e.status.action,"job-name":e.job.name},on:{jobActionExecuted:function(i){return e.$emit("jobActionExecuted")}}}):e._e(),e._v(" "),e.hasUnauthorizedManualAction?i("job-action-button",{staticClass:"gl-ml-6",attrs:{disabled:"","job-id":e.job.id,"job-action":e.unauthorizedManualAction,"job-name":e.job.name}}):e._e()],1)]},proxy:!0}])})}),[],!1,null,null,null);i.a=T.exports}}]);
//# sourceMappingURL=9da34f7a.d6e793b4.chunk.js.map